# A* Path Finding Algorithm
&nbsp;

## 어떻게 돌아가는 걸까?

자바스크립트로 A* 알고르즘을 시각화 해보고 싶어졌다.  
예전부터 공부해왔긴 하지만 완벽하기 이해하고 있지 못했기도 해서 이번에 해보기로 한다.

처음에는 이해가 안되서 유튜브를 수십개는 본 듯 하다.  
전반적인 개념은 이해가 갔지만 벽에 부딪혔을 때, F값 재정의는 언제해야 하는지, 왜 내 알고리즘은 더 넓은 범위를 탐색하는지... 구현 중 맞닥뜨리는 궁금증에 대한 해석은 없었다.  
뭐 방법이 있나... 여러 코드 분석해보고 더 많은 동영상을 봐보는 수 밖에...
회사에서 할 일도 많은데, 공부할 것도 쌓여있고 프론트에서 쓸일이 있겠어? 하고 넘어가기에는 이미 시작한 걸 그만 두는 성격은 아니라 일단 계속 파보기로 했다.

> 이해하는데 걸렸던 시간에 비하면, 그 핵심 원리는 간단했다.

주변 노드를 모두 검색해서 골까지의 F 값이 제일 작은 값으로 현재 위치를 이동시키고 다시 주변 노드를 재 검색... 의 반복.
물론 아직 이해하지 못하고 그냥 사용하기만 하는 것 도 있다.
왜 Heuristic 값을 구할 때 Manhattan 택시 거리 함수가 최적의 방식이지?
추측으로는 뉴욕은 계획 도시? 이기 때문에 블록화가 잘 되어 있고 한 지점에서 한 지점으로 이동하는 최단거리는 지점과 지점 사이의 일직선이 아닌 삼각형의 외변의 합이겠거니...?

```**(X2 - X1) + (Y2 - Y1)**```

> 구현은 생각보다 간단? 하네 ...

```
현재 노드에서 부모 노드까지의 거리를 G
현재 노드에서 최종 목적지 노드까지의 거리를 H (Heuristic)
이 두 값을 더한 값을 F = G + H

시작노드에서부터 시작하여 벽을 제외한 인접한 모든 노드의 F 값을 계산,
그 중 가장 적은 F 값을 가진 노드로 이동하여 같은 작업을 반복한다.
그러다가 타겟 노드를 발견하면 종료
```

이해하고 나서 나무위키에 다시 방문해보니 짧지만 핵심정리가 잘 되어 있다.
괜히 영어로 된 유튜브 동영상부터 시작해서 한참 해맷다...
[나무위키](https://namu.wiki/w/A*%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98)

&nbsp;

## 구현

to be continued ...

&nbsp;

## 마치며

구현해보고자 마음먹은지는 꽤 됐었는데 이제야 어찌어찌 돌아가는 버전을 만들게 되어 짐 하나를 덜은 듯 하다.  

당분간 손은 안대겠지만서도... 그래도 시간이 난다면 개선하고 싶은 부분이 좀 있다.  

* Heuristic function 최적화
* F Cost 재계산 로직
* 현재는 재탐색을 위해 클래스를 매번 초기화 해주고 있는데, 페이지 진입 시 처음 한번만 해주면 될 것 같다.
  * 맵만 초기화 해주는게 귀찮아서 일단 이렇게 했는데 모든 노드 정보를 가지고 있는 Astar 클래스 인스턴스는 한번만 생성해주면 될 듯
* 벽 클릭 시 이동하지 않는데 가장 최단거리 노드로 이동하도록
* 다수의 노드를 배치한 후 타겟으로 동시에 이동
  * 스타 크래프트 유닛 이동처럼
  * 이를 위해 최단거리 노드 이동 로직 작성이 필수일 듯. 한 노드가 골을 선점하면 뒤따르는 노드들은 최단거리에 위치할 수 있도록
* 시작노드에서 타겟노드로 이동하는 중간에 클릭 이벤트가 발생하면 그 시점의 노드가 시작노드가 되고 새로운 타겟노드로 이동하는 로직 구현

이렇게 써보니 뭔가 2D 게임구현같은데 해보면 재미있을 것 같다.


&nbsp;&nbsp;&nbsp;

---


**>> [A* 데모 보기](/apps/astar)**

**>> [Astar-JS in GitLab](https://github.com/cheonsoo/astar-js)**



![Image](http://static.devnology.co.kr/files/posts/astar/astar_sample_1.png)
